# Threat Intelligence Exchange

在威胁情报领域，用最简易的收集，产生有价值的交换。



## 目的

用最简易的收集，产生有价值的交换。

### 为什么要进行威胁信息交换？

#### 从技术角度

交换信息可以更快地检测到目标攻击并提高检测率，同时减少误报。[1]

从技术上来看，威胁情报的用处就在于支撑风险防控工作。



#### 从效果角度

威胁情报的生产和消费是一个循环。

用分享、交换的过程来促进情报的消费，使得威胁情报的这个生产——消费循环能转动起来。

我们的项目所要做的，就是能促进这个循环，一方面推动生产，一方面刺激消费。对于我们来说，我们对于威胁情报的深度工作，肯定是在短时间内无法达到很好的效果的。所以我们的方向和优势，就是可以做一个连接学术、业务、安全的宽度工作。





## 竞品分析

主要指匹配程度高，且较为成熟的

-   [act-platform](https://github.com/mnemonic-no/act-platform)
    -   [官网](https://www.mnemonic.no/research-and-development/semi-automated-cyber-threat-intelligence/)
-   [IBM X-Force Exchange](https://www.ibm.com/cn-zh/security/xforce)

-   [MISP](https://github.com/MISP/MISP)

## 需求和痛点

- 公司内部，威胁数据不互通
- 对于非安全人员，威胁数据采集本身就是个问题
- 琐碎信息太多，情报验证困难
- 非安全部门对于情报的处置不够专业
- 情报的需求不再局限于威胁情报
    - 风控部门关注的和安全部门关注的不一样
    - 安全部门内部间也有不同的关注点
- 安全能力部门很难处理整个公司的全部威胁数据，并且数据的共享互通也是一个问题



## 功能大纲

### 采集

#### 支持的数据源

-   三级TI
    -   Entity
        -   Malware
        -   TTP
        -   Actor
        -   Campaign
        -   Exploit
        -   Exploit Kit
        -   Company
    -   Indicator
        -   Regular Expression
        -   Yara Rule

-   二级TI

    -   告警数据

    -   流量数据

    -   OSINT

        -   开源IOC库

            -   例如，黑名单IP列表：[IPsum](https://raw.githubusercontent.com/stamparm/ipsum/master/ipsum.txt)
            -   例如，IOC库：https://maltiverse.com/search

        -   威胁报告

            -   攻击事件报告（攻击者维度）
            -   漏洞通报（资产维度）
            -   安全日/周/季/年报告（趋势维度）

        -   TI 平台

            -   [Pulsedive](https://pulsedive.com/)
            -   [Maltiverse](https://maltiverse.com/search)

            

    -   EDR数据

    -   NSM数据

    -   SIEM数据

-   一级TI

    -   威胁笔记
        -   Threat Note
    -   上传样本

    

### 生产

生产，其实我们的核心。

我们的收集是用于生产，关联的数据来自生产，交换后的数据也用于生产。



### 关联



### 交换

  

## 威胁情报分类

- 一级威胁情报
    - 可以是最简单的笔记形式
    - 提供疑似威胁的基本信息
- 二级威胁情报
    - 经过安全软硬件获得的告警信息，需要进一步核验
    - 提供威胁数据源
- 三级威胁情报
    - 经过核验且实际响应中获得的信息
    - 提供专家经验



## 平台所做的事情

交换平台总共就做四件事

- 收集
- 生产
- 关联
- 交换

用最简易的收集，产生有价值的交换

---

-   扩展收集渠道，全员参与
-   降低收集难度，笔记式采集
-   生产、关联部分人机结合
-   最终是让不同来源的数据产生火花



## 依赖的技术

### 网络威胁情报共享模型

-   [可信的指标信息自动交换](https://taxiiproject.github.io/)（TAXII）
-   [网络可观察表达](https://cyboxproject.github.io/)（CybOX）
-   [结构化威胁信息表达](https://stixproject.github.io/)（STIX）
- [一种网络威胁情报共享模型·专利](https://patentimages.storage.googleapis.com/cf/40/d3/bc397d99d6b623/CN106060018A.pdf)

### 共享格式整理

Standardized formats for sharing Threat Intelligence (mostly IOCs).

| [CAPEC](https://capec.mitre.org/)                            | The Common Attack Pattern Enumeration and Classification (CAPEC) is a comprehensive dictionary and classification taxonomy of known attacks that can be used by analysts, developers, testers, and educators to advance community understanding and enhance defenses. |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [CybOX](https://cyboxproject.github.io/)                     | The Cyber Observable eXpression (CybOX) language provides a common structure for representing cyber observables across and among the operational areas of enterprise cyber security that improves the consistency, efficiency, and interoperability of deployed tools and processes, as well as increases overall situational awareness by enabling the potential for detailed automatable sharing, mapping, detection, and analysis heuristics. |
| [IODEF (RFC5070)](https://tools.ietf.org/html/rfc5070)       | The Incident Object Description Exchange Format (IODEF) defines a data representation that provides a framework for sharing information commonly exchanged by Computer Security Incident Response Teams (CSIRTs) about computer security incidents. |
| [IDMEF (RFC4765)](https://tools.ietf.org/html/rfc4765)       | *Experimental* - The purpose of the Intrusion Detection Message Exchange Format (IDMEF) is to define data formats and exchange procedures for sharing information of interest to intrusion detection and response systems and to the management systems that may need to interact with them. |
| [MAEC](https://maecproject.github.io/)                       | The Malware Attribute Enumeration and Characterization (MAEC) projects is aimed at creating and providing a standardized language for sharing structured information about malware based upon attributes such as behaviors, artifacts, and attack patterns. |
| [OpenC2](https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=openc2) | OASIS Open Command and Control (OpenC2) Technical Committee. The OpenC2 TC will base its efforts on artifacts generated by the OpenC2 Forum. Prior to the creation of this TC and specification, the OpenC2 Forum was a community of cyber-security stakeholders that was facilitated by the National Security Agency (NSA). The OpenC2 TC was chartered to draft documents, specifications, lexicons or other artifacts to fulfill the needs of cyber security command and control in a standardized manner. |
| [STIX 2.0](https://oasis-open.github.io/cti-documentation/)  | The Structured Threat Information eXpression (STIX) language is a standardized construct to represent cyber threat information. The STIX Language intends to convey the full range of potential cyber threat information and strives to be fully expressive, flexible, extensible, and automatable. STIX does not only allow tool-agnostic fields, but also provides so-called *test mechanisms* that provide means for embedding tool-specific elements, including OpenIOC, Yara and Snort. STIX 1.x has been archived [here](https://stixproject.github.io/). |
| [TAXII](https://taxiiproject.github.io/)                     | The Trusted Automated eXchange of Indicator Information (TAXII) standard defines a set of services and message exchanges that, when implemented, enable sharing of actionable cyber threat information across organization and product/service boundaries. TAXII defines concepts, protocols, and message exchanges to exchange cyber threat information for the detection, prevention, and mitigation of cyber threats. |
| [VERIS](http://veriscommunity.net/index.html)                | The Vocabulary for Event Recording and Incident Sharing (VERIS) is a set of metrics designed to provide a common language for describing security incidents in a structured and repeatable manner. VERIS is a response to one of the most critical and persistent challenges in the security industry - a lack of quality information. In addition to providing a structured format, VERIS also collects data from the community to report on breaches in the Verizon Data Breach Investigations Report ([DBIR](http://www.verizonenterprise.com/verizon-insights-lab/dbir/)) and publishes this database online at [VCDB.org](http://vcdb.org/index.html). |




## 技术参考

### 收集功能的参考

-   [threat_note](https://github.com/DefensePointSecurity/threat_note) - 用于方便安全研究人员添加和检索与他们自己研究的相关指标，是一个由Defence Point Security（一个美国的网络安全公司）构建的Web应用程序
    注：简单讲，这个平台目前实现的功能是一个便于添加攻击者向量（IoC）的一个笔记应用



### 生产功能的参考

-   ThreatIngestor - 可扩展工具，用于从威胁源（包括Twitter，RSS或其他源）提取和聚合IOC
-   [HELK](https://thehelk.com/how-to/docker/load-images.html), 威胁狩猎工具
    -   ![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200813141646.png)



### 关联功能的参考

-   ~~威胁情报的关联部分，主要需要我们自己写逻辑，逻辑要根据专家经验~~

-   [Manati](https://github.com/stratosphereips/Manati) - 通过采用机器学习技术来自动帮助发现新的关系和推断，从而帮助威胁分析人员



## 理论依据

![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200811164956.png)

![](https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20200811153303.png)



## References

\[1] MISP-开源威胁情报和共享平台, Wh0le, https://wh0ale.github.io/2019/11/19/MISP-%E5%BC%80%E6%BA%90%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E5%92%8C%E5%85%B1%E4%BA%AB%E5%B9%B3%E5%8F%B0/